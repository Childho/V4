CREATE TABLE user_tasks (
    id INT AUTO_INCREMENT PRIMARY KEY COMMENT '用户任务ID',
    user_id INT NOT NULL COMMENT '用户ID，外键关联users表',
    task_id INT NOT NULL COMMENT '任务ID，外键关联tasks表',
    status INT NOT NULL COMMENT '完成状态（0未完成/1已完成）',
    completed_at TIMESTAMP COMMENT '完成时间',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    FOREIGN KEY (user_id) REFERENCES users(id),
    FOREIGN KEY (task_id) REFERENCES tasks(id)
) COMMENT='用户任务表';


CREATE TABLE string_service (
    id INT AUTO_INCREMENT PRIMARY KEY COMMENT '穿线服务ID',
    user_id INT NOT NULL COMMENT '用户ID，外键关联users表',
    racket_brand VARCHAR(50) NOT NULL COMMENT '球拍品牌型号',
    pounds INT NOT NULL COMMENT '磅数',
    string_id VARCHAR(50) NOT NULL COMMENT '线材ID，外键关联strings表',
    remark TEXT COMMENT '备注',
    status VARCHAR(20) NOT NULL COMMENT '状态（pending待接单/processing处理中/completed已完成）',
    total_price DECIMAL(10,2) NOT NULL COMMENT '总价格',
    estimated_time VARCHAR(50) COMMENT '预计完成时间',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    FOREIGN KEY (user_id) REFERENCES users(id),
    FOREIGN KEY (string_id) REFERENCES strings(id)
) COMMENT='穿线服务表';
CREATE TABLE strings (
    id VARCHAR(50) PRIMARY KEY COMMENT '线材ID',
    name VARCHAR(50) NOT NULL COMMENT '线材名称',
    brand VARCHAR(50) NOT NULL COMMENT '品牌',
    description TEXT COMMENT '描述',
    price DECIMAL(10,2) NOT NULL COMMENT '价格',
    stock INT NOT NULL COMMENT '库存',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间'
) COMMENT='线材表';

CREATE TABLE promotions (
    id INT AUTO_INCREMENT PRIMARY KEY COMMENT '推广ID',
    user_id INT NOT NULL COMMENT '用户ID，外键关联users表',
    invite_code VARCHAR(50) NOT NULL UNIQUE COMMENT '邀请码',
    total_earnings DECIMAL(10,2) DEFAULT 0 COMMENT '累计收益',
    account_balance DECIMAL(10,2) DEFAULT 0 COMMENT '账户余额',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    FOREIGN KEY (user_id) REFERENCES users(id)
) COMMENT='推广返佣表';
CREATE TABLE commission_records (
    id INT AUTO_INCREMENT PRIMARY KEY COMMENT '佣金记录ID',
    promotion_id INT NOT NULL COMMENT '推广ID，外键关联promotions表',
    amount DECIMAL(10,2) NOT NULL COMMENT '佣金金额',
    description VARCHAR(255) COMMENT '描述',
    type VARCHAR(20) NOT NULL COMMENT '类型（invite邀请/commission返佣）',
    status VARCHAR(20) NOT NULL COMMENT '状态（pending待到账/settled已到账）',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    FOREIGN KEY (promotion_id) REFERENCES promotions(id)
) COMMENT='佣金记录表';