
-- 商品品牌表
CREATE TABLE `product_brand` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '品牌ID，主键',
  `brand_name` varchar(100) NOT NULL COMMENT '品牌名称',
  `brand_logo` varchar(255) DEFAULT NULL COMMENT '品牌Logo URL',
  `brand_desc` text COMMENT '品牌描述',
  `status` tinyint DEFAULT 1 COMMENT '状态：0禁用，1启用',
  `create_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
  PRIMARY KEY (`id`),
  UNIQUE KEY `idx_brand_name` (`brand_name`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='商品品牌表';

-- 商品表
CREATE TABLE `product` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '商品ID，主键',
  `product_name` varchar(200) NOT NULL COMMENT '商品名称',
  `category_id` bigint NOT NULL COMMENT '分类ID，关联product_category表',
  `brand_id` bigint DEFAULT NULL COMMENT '品牌ID，关联product_brand表',
  `product_sn` varchar(100) DEFAULT NULL COMMENT '商品编号',
  `market_price` decimal(10,2) NOT NULL COMMENT '市场价格',
  `sale_price` decimal(10,2) NOT NULL COMMENT '销售价格',
  `cost_price` decimal(10,2) DEFAULT NULL COMMENT '成本价格',
  `stock` int DEFAULT 0 COMMENT '库存数量',
  `min_stock` int DEFAULT 0 COMMENT '库存预警值',
  `weight` decimal(10,2) DEFAULT NULL COMMENT '商品重量（kg）',
  `volume` decimal(10,2) DEFAULT NULL COMMENT '商品体积（m³）',
  `brief` varchar(255) DEFAULT NULL COMMENT '商品简介',
  `description` text COMMENT '商品详情描述',
  `is_on_sale` tinyint DEFAULT 0 COMMENT '是否上架：0否，1是',
  `is_hot` tinyint DEFAULT 0 COMMENT '是否热销：0否，1是',
  `is_new` tinyint DEFAULT 0 COMMENT '是否新品：0否，1是',
  `is_recommend` tinyint DEFAULT 0 COMMENT '是否推荐：0否，1是',
  `sales_volume` int DEFAULT 0 COMMENT '销量',
  `views` int DEFAULT 0 COMMENT '浏览量',
  `comments` int DEFAULT 0 COMMENT '评论数',
  `sort_order` int DEFAULT 0 COMMENT '排序值，值越小越靠前',
  `status` tinyint DEFAULT 1 COMMENT '状态：0删除，1正常',
  `create_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
  PRIMARY KEY (`id`),
  KEY `idx_category_id` (`category_id`),
  KEY `idx_brand_id` (`brand_id`),
  KEY `idx_is_on_sale` (`is_on_sale`),
  KEY `idx_sort_order` (`sort_order`),
  FOREIGN KEY (`category_id`) REFERENCES `product_category` (`id`),
  FOREIGN KEY (`brand_id`) REFERENCES `product_brand` (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='商品表';

-- 商品图片表
CREATE TABLE `product_image` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '图片ID，主键',
  `product_id` bigint NOT NULL COMMENT '商品ID，关联product表',
  `image_url` varchar(255) NOT NULL COMMENT '图片URL',
  `sort_order` int DEFAULT 0 COMMENT '排序值，值越小越靠前',
  `is_cover` tinyint DEFAULT 0 COMMENT '是否封面图：0否，1是',
  `create_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  PRIMARY KEY (`id`),
  KEY `idx_product_id` (`product_id`),
  FOREIGN KEY (`product_id`) REFERENCES `product` (`id`) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='商品图片表';

-- 商品属性表
CREATE TABLE `product_attribute` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '属性ID，主键',
  `attr_name` varchar(100) NOT NULL COMMENT '属性名称',
  `attr_group` varchar(100) DEFAULT NULL COMMENT '属性分组',
  `is_filter` tinyint DEFAULT 0 COMMENT '是否用于筛选：0否，1是',
  `sort_order` int DEFAULT 0 COMMENT '排序值',
  `status` tinyint DEFAULT 1 COMMENT '状态：0禁用，1启用',
  `create_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` datetime DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
  PRIMARY KEY (`id`),
  KEY `idx_attr_group` (`attr_group`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='商品属性表';

-- 商品属性值表
CREATE TABLE `product_attribute_value` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '属性值ID，主键',
  `attr_id` bigint NOT NULL COMMENT '属性ID，关联product_attribute表',
  `attr_value` varchar(255) NOT NULL COMMENT '属性值',
  `sort_order` int DEFAULT 0 COMMENT '排序值',
  PRIMARY KEY (`id`),
  KEY `idx_attr_id` (`attr_id`),
  FOREIGN KEY (`attr_id`) REFERENCES `product_attribute` (`id`) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='商品属性值表';