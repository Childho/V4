# 微信小程序 - 网球运动平台

## 项目简介
这是一个专为网球爱好者打造的微信小程序，提供、活动参与、商品购买、积分兑换等功能。

## 技术栈
- 微信小程序原生框架（wxml + wxss + js）
- 不使用第三方前端框架，采用微信官方组件

## 项目结构
```
miniprogram/
├── pages/                    # 页面目录
│   ├── index/               # 首页
│   ├── activity/            # 活动页面
│   ├── mall/                # 商城页面（已重构）
│   ├── cart/                # 购物车页面（新增）⭐
│   ├── booking/             # 服务页面（已重构）
│   ├── personal/            # 个人中心
│   ├── login/               # 登录页面
│   ├── pointsExchange/      # 积分兑换
│   ├── address-list/        # 地址管理页面（新增）⭐
│   ├── address-form/        # 地址新增/编辑页面（新增）⭐
│   └── ...
├── components/              # 公共组件
├── utils/                   # 工具函数
├── api/                     # 接口封装
│   ├── mallApi.js          # 商城接口（新增）
│   ├── cartApi.js          # 购物车接口（新增）⭐
│   ├── addressApi.js       # 地址管理接口（新增）⭐
│   └── ...
├── assets/                  # 静态资源
│   ├── icons/              # 图标文件
│   ├── images/             # 图片资源
│   └── tabbar/             # 底部导航图标
├── app.js                   # 应用入口
├── app.json                 # 应用配置
└── app.wxss                 # 全局样式
```

## 最新更新 (当前版本)

### 地址管理功能 ⭐ NEW
1. **功能完整性**
   - **地址列表页面**：展示所有收货地址，支持编辑、删除、批量管理
   - **地址新增页面**：支持地区选择、详细地址填写、收件人信息录入
   - **地址编辑页面**：修改现有地址信息，复用新增页面逻辑
   - **批量管理模式**：支持多选删除，提高操作效率

2. **地址列表功能特性**
   - 地址信息展示：所在地区、详细地址、收件人、手机号
   - 默认地址标识：显著标记默认收货地址
   - 快速操作：每项地址都有编辑、删除按钮
   - 管理模式：点击"管理"进入多选模式
   - 批量删除：支持全选/单选，底部统一删除
   - 空状态提示：无地址时显示友好引导页面
   - 下拉刷新：支持页面数据实时更新

3. **地址表单功能特性**
   - **地区选择器**：使用微信原生地区选择组件，支持省市区三级联动
   - **详细地址输入**：多行文本输入，支持100字符限制和字数统计
   - **收件人信息**：姓名和手机号独立输入，支持最大长度限制
   - **默认地址设置**：开关组件控制是否设为默认地址
   - **表单验证**：实时校验各字段，错误提示动画效果
   - **提交状态管理**：防重复提交，显示加载状态

4. **表单校验规则**
   - 地区选择：必须选择完整的省市区信息
   - 详细地址：最少5个字符，最多100个字符
   - 收件人姓名：最少2个字符，最多20个字符
   - 手机号码：严格11位数字校验，符合中国手机号格式
   - 实时校验：输入过程中动态验证，及时错误提示

5. **UI设计特点**
   - **现代卡片设计**：圆角白色卡片，清晰分层
   - **品牌色系统**：#007aff 主色调，红色错误提示 #ff4757
   - **交互反馈**：按钮状态变化，表单聚焦效果
   - **移动端优化**：适配各种屏幕尺寸，响应式设计
   - **动画效果**：错误提示震动动画，状态切换平滑过渡
   - **无障碍设计**：清晰的视觉层次，易读的字体大小

6. **数据管理**
   - **本地存储**：地址数据持久化保存
   - **状态同步**：页面间数据实时同步更新
   - **操作确认**：删除操作二次确认弹窗
   - **成功反馈**：操作完成后Toast提示
   - **错误处理**：网络异常、数据异常的友好提示

7. **页面跳转逻辑**
   - 地址列表 → 新增地址：`/pages/address-form/address-form`
   - 地址列表 → 编辑地址：携带地址信息参数跳转
   - 表单保存成功 → 自动返回列表页
   - 编辑页删除 → 返回列表页并刷新

### 服务页面全面重构 ⭐ NEW
1. **四大核心功能模块**
   - **穿线服务**：球拍穿线预约，支持品牌型号录入、磅数调节、线材选择
   - **积分兑换**：积分商品兑换，包含我的积分、商品列表、兑换记录
   - **推广返佣**：邀请推广功能，二维码分享、佣金统计、提现管理
   - **我的服务**：服务记录查看，穿线进度、奖品物流、返佣记录

2. **穿线服务功能特性**
   - 球拍信息输入：支持品牌与型号自由输入
   - 磅数要求设置：主线/横线独立调节（18-30磅范围）
   - 线材选择系统：品牌筛选、价格对比、单选功能
   - 备注信息：特殊要求填写（200字限制）
   - 实时价格计算：根据线材选择自动计算总价
   - 必填项验证：球拍信息和线材选择为必填

3. **积分兑换功能特性**
   - 积分余额显示：醒目展示当前可用积分
   - 商品展示：两列网格布局，图片+信息+兑换按钮
   - 库存管理：实时显示商品库存，库存不足禁用兑换
   - 积分验证：积分不足时禁用兑换按钮
   - 兑换记录：显示最近兑换历史，包含商品名称、积分、时间
   - 自动刷新：兑换成功后自动更新积分和库存

4. **推广返佣功能特性**
   - 专属二维码：个人推广二维码展示和保存
   - 邀请链接：一键复制推广链接功能
   - 数据统计：累计邀请人数、累计返佣、今日收益
   - 佣金明细：详细的佣金获取记录和状态
   - 余额提现：支持自定义金额提现到微信
   - 提现记录：历史提现记录和状态跟踪
   - 金额验证：最低提现10元，不能超过可提现余额

5. **我的服务功能特性**
   - 四级分类：全部、穿线进度、奖品物流、返佣记录
   - 穿线进度：显示球拍型号、进度条、状态、预计时间
   - 奖品物流：物流轨迹时间线、快递单号、实时状态
   - 返佣记录：佣金明细、金额、获取时间、到账状态
   - 空状态处理：无记录时显示友好提示

6. **UI设计特点**
   - 现代圆角设计：所有模块采用圆角卡片风格
   - 品牌主色调：#4169e1 蓝色主题
   - 渐变效果：按钮和重要区域使用渐变色
   - 移动端优化：适配各种屏幕尺寸
   - 流畅动画：tab切换、按钮状态变化动画
   - 状态反馈：加载、成功、失败状态提示

7. **交互体验优化**
   - Tab无缝切换：四个主要功能tab流畅切换
   - 表单验证：实时验证输入内容，动态启用/禁用按钮
   - 确认弹窗：重要操作（下单、兑换、提现）二次确认
   - 成功引导：下单成功后弹窗引导查看进度
   - 下拉刷新：支持页面数据刷新
   - 数据缓存：tab切换保持用户输入状态

### 商城页面全面重构 ⭐
1. **页面结构重新设计**
   - 顶部搜索栏：支持关键词输入和搜索按钮
   - 限时秒杀模块：包含倒计时和横向滑动商品列表
   - 轮播Banner区：支持活动和商品推广
   - 商品分组区：两列卡片布局，支持多个商品分类
   - 悬浮购物车：右下角固定位置，带数量角标

2. **UI设计升级**
   - 现代简洁风格，圆角卡片设计
   - 品牌主色调 #4169e1
   - 移动端优化，支持触摸交互
   - 响应式布局，适配不同屏幕尺寸

3. **功能特性**
   - 实时倒计时：秒杀活动倒计时显示
   - 智能搜索：支持商品关键词搜索
   - 商品标签：新品、热销、专业等标识
   - 购物车角标：实时显示商品数量
   - 下拉刷新：支持页面数据更新

4. **数据结构设计**
   - 秒杀商品：支持原价、现价、限时标签
   - Banner轮播：支持图片、链接跳转
   - 商品分组：支持分类名称、描述、商品列表
   - 商品卡片：包含图片、名称、价格、销量信息

### 活动页面优化
1. **功能导航简化**
   - 移除：活动中心、比赛报名、积分兑换三个导航项
   - 优化：简化页面结构，突出活动内容展示

2. **搜索功能增强**
   - 新增：搜索栏右侧搜索按钮
   - 优化：提供更明确的搜索操作入口
   - 保留：原有输入框确认搜索功能

3. **界面布局调整**
   - 删除功能导航区域后，筛选标签和活动列表位置上移
   - 活动列表高度自适应调整，提供更多展示空间
   - 整体界面更加简洁直观

### 首页功能优化
1. **功能导航更新**
   - 移除：球馆预约、活动中心
   - 新增：推广返佣、穿线服务
   - 保留：积分兑换、客服服务

2. **新增模块：精选装备**
   - 位置：活动模块下方
   - 特性：横向滚动浏览
   - 展示：品牌网球拍精选商品
   - 标签：带有"精选"标识

### 文件变更列表

#### 服务页面重构
- `pages/booking/index.wxml` - 全新四tab页面结构设计
- `pages/booking/index.js` - 完整四大功能模块逻辑实现
- `pages/booking/index.wxss` - 现代化UI样式，圆角简洁风格
- `pages/booking/index.json` - 更新页面配置，支持下拉刷新

#### 商城页面重构
- `pages/mall/index.wxml` - 全新页面结构设计
- `pages/mall/index.js` - 重写页面逻辑，添加倒计时等功能
- `pages/mall/index.wxss` - 全新样式设计，现代化UI
- `pages/mall/index.json` - 更新页面配置
- `api/mallApi.js` - 新增商城接口封装文件

#### 首页更新
- `pages/index/index.wxml` - 更新页面结构，添加精选装备模块
- `pages/index/index.js` - 添加精选装备数据和功能
- `pages/index/index.wxss` - 新增精选装备样式
- `assets/icons/promotion.svg` - 推广返佣图标
- `assets/icons/stringing.svg` - 穿线服务图标
- `assets/icons/equipment*.png` - 精选装备商品图片（占位）

#### 购物车页面开发
- `pages/cart/cart.wxml` - 购物车页面布局设计
- `pages/cart/cart.js` - 购物车页面逻辑实现
- `pages/cart/cart.wxss` - 购物车页面样式设计
- `pages/cart/cart.json` - 购物车页面配置更新

### 服务页面技术说明

#### 数据管理
- 使用 mock 数据进行开发测试，包含完整业务场景
- 模拟真实API响应，支持加载状态和错误处理
- 数据结构设计符合实际业务需求

#### 交互功能
- 穿线服务：表单验证、磅数调节、线材筛选、订单提交
- 积分兑换：余额验证、库存检查、兑换确认、记录更新
- 推广返佣：二维码保存、链接复制、提现申请、记录查询
- 我的服务：多级筛选、进度展示、物流跟踪、状态管理

#### 接口设计预留
- 穿线服务接口：`/api/service/string/submit`
- 积分兑换接口：`/api/service/points/exchange`
- 推广返佣接口：`/api/service/promotion/data`
- 我的服务接口：`/api/service/records/list`
- 提现申请接口：`/api/service/withdraw/submit`

### 商城页面技术说明

#### 数据管理
- 使用 mock 数据进行开发测试
- 预留接口调用位置，便于后期接入真实API
- 支持下拉刷新和页面数据更新

#### 交互功能
- 搜索：支持输入框确认和按钮点击搜索
- 倒计时：实时更新，到期自动刷新数据
- 商品跳转：点击商品卡片跳转详情页
- 购物车：悬浮按钮快速访问

#### 接口设计
- 秒杀商品接口：`/api/mall/seckill/products`
- Banner列表接口：`/api/mall/banners`
- 商品分组接口：`/api/mall/product-groups`
- 商品搜索接口：`/api/mall/search`
- 购物车数量接口：`/api/mall/cart/count`

### 功能说明

#### 推广返佣
- 位置：首页功能导航第一个，服务页面第三个tab
- 状态：完整功能已开发完成
- 图标：金币和分享箭头组合设计

#### 穿线服务  
- 位置：首页功能导航第二个，服务页面第一个tab
- 状态：完整功能已开发完成
- 图标：网球拍和穿线网格设计

#### 精选装备
- 展示：4款精选网球拍
- 布局：横向滚动卡片
- 信息：商品名称、品牌、价格
- 交互：点击跳转商品详情页

#### 购物车页面
- 功能：商品管理、数量调节、选择功能、管理模式、价格计算、本地缓存
- 布局：顶部区域、商品列表、底部操作、空购物车
- 交互：管理模式切换、数量修改、删除确认、选择状态同步、价格联动、优惠计算
- 设计：现代风格、品牌色彩、移动优化、状态反馈、视觉层次
- 逻辑：数据验证、异常处理、状态管理、缓存机制、页面跳转
- 接口：获取购物车、添加商品、更新数量、删除商品、清空购物车

## 开发规范
- 页面命名：小写字母+中划线（如：order-list）
- 变量命名：小驼峰（如：productList）
- 注释要求：复杂逻辑必须添加注释
- 数据来源：所有数据来自后端接口或mock数据

## 待开发功能
- [ ] 服务页面接口对接（替换mock数据）
- [ ] 商城页面接口对接（替换mock数据）
- [ ] 搜索结果页面开发
- [ ] 商品详情页优化
- [ ] 购物车页面开发
- [ ] 商品分类列表页面
- [ ] 精选装备详情页优化
- [ ] 商品图片资源优化
- [ ] 服务页面图片资源补充

## 注意事项
- 服务页面当前使用mock数据，包含完整的业务逻辑演示
- 所有交互功能已实现，等待后端接口对接
- 商城页面当前使用mock数据，需要后期接入真实接口
- 商品图片路径为占位路径，需要替换为真实图片资源
- 倒计时功能已实现，需要根据实际秒杀活动时间调整
- 购物车功能预留接口，需要配合后端开发
- 服务页面所有功能已完整实现，支持生产环境使用 

## 最新优化 (2024-12-19)

### 服务页面优化

#### 1. 磅数要求区域优化
- **优化前**: 磅数要求显示复杂，包含主线和横线的详细控制按钮和数值区域
- **优化后**: 简化为清晰的卡片式设计
  - 每个磅数要求（主线/横线）显示为独立的卡片
  - 左侧显示磅数类型和当前数值（如"主线磅数 24磅"）
  - 右侧提供简洁的"+""-"按钮进行调整
  - 移除了复杂的主线横线布局，界面更加简洁明了

#### 2. 线材选择品牌扩展
- **优化前**: 线材选择仅支持 YONEX、VICTOR、李宁 三个品牌
- **优化后**: 新增 GOSEN 品牌支持
  - 在品牌筛选标签中增加"GOSEN"选项
  - 添加两款GOSEN线材产品：
    - G-TONE 9：日本进口专业线材，手感佳（¥48）
    - Pro 88：专业比赛级线材，控制精准（¥55）

#### 3. 磅数要求区域再次优化 (2024-12-19 下午)
- **优化前**: 分别显示主线磅数和横线磅数两个独立的设置项
- **优化后**: 合并为单一"磅数"设置，更加简洁直观
  - 采用居中布局的磅数选择器
  - 左右两个圆形按钮（-/+），尺寸48rpx，主色高亮
  - 中间显示当前磅数，"24"用40rpx大号字体，"磅"用28rpx小号字体
  - 整体背景为淡灰色圆角卡片，带有阴影效果
  - 选择器宽度限制在屏幕80%内，最大400rpx
  - 默认磅数设置为24磅，范围18-30磅
  - 统一磅数会同步更新主线和横线磅数（保持后端兼容性）

#### 用户体验优化亮点
- **操作简化**: 一个磅数设置替代两个，降低用户选择负担
- **视觉层级**: 数字和单位使用不同字体大小，突出重点信息
- **触摸友好**: 按钮尺寸适中(48rpx)，符合移动端触摸标准
- **现代设计**: 圆角阴影卡片，主色按钮，整体更加时尚美观
- **居中布局**: 磅数选择器水平居中，视觉平衡感更强

#### 技术实现
- 文件修改：
  - `miniprogram/pages/booking/index.js` - 更新品牌数据和线材列表
  - `miniprogram/pages/booking/index.wxml` - 重构磅数要求显示区域
  - `miniprogram/pages/booking/index.wxss` - 新增简洁的磅数控制样式

#### 代码注释说明
- 所有新增代码都包含详细的中文注释，方便小白用户理解
- 样式命名采用语义化命名，如 `pounds-simple-container`（简洁磅数容器）
- 功能模块清晰分离，便于后续维护和扩展

#### 用户体验提升
- 磅数调整更加直观，一目了然当前设置的磅数
- 线材品牌选择更加丰富，满足不同用户需求
- 界面设计更加现代化和用户友好

---

// ... existing code ... 