# 微信小程序项目

## 项目结构

### 页面目录 (/pages)
- `index/` - 首页
- `login/` - 登录页面
- `personal/` - 个人中心页面
- `activity/` - 活动页面
- `mall/` - 商城页面
- `cart/` - 购物车页面
- `order-confirm/` - 订单确认页面
- **`order-list/` - 我的订单页面** ✅
- **`refund-detail/` - 退款详情页面** ✅
- `booking/` - 服务预订页面
- `seckill/` - 秒杀页面
- `activityDetail/` - 活动详情页面
- `productDetail/` - 商品详情页面
- `courseDetail/` - 课程详情页面
- `myBooking/` - 我的预订页面
- `myPoints/` - 我的积分页面
- `pointsExchange/` - 积分兑换页面
- `dailyCheck/` - 每日签到页面
- `search-result/` - 搜索结果页面
- **`address-list/` - 地址管理页面** ✅
- **`address-form/` - 地址新增/编辑页面** ✅
- **`logistics/` - 物流查询页面** ✅

### API目录 (/api)
- `userApi.js` - 用户相关API
- **`addressApi.js` - 地址管理相关API** ✅
- `utils/request.js` - 网络请求工具

### 组件目录 (/components)
- 公共组件存放位置

### 静态资源目录 (/assets)
- `icons/` - 图标文件
- `images/` - 图片文件

## 最新开发 - 订单管理功能完整实现

### 功能概述
完整开发了订单管理模块，包含订单列表展示、订单状态管理和订单操作功能，支持从个人中心的"我的订单"模块进入。

### 核心功能
1. **订单状态分类** (`pages/order-list/`)
   - ✅ 全部订单：显示所有状态的订单
   - ✅ 待付款：显示未支付的订单，支持付款和取消
   - ✅ 待发货：显示已付款待发货的订单，支持催发货
   - ✅ 待收货：显示运输中的订单，支持查看物流和确认收货
   - ✅ 待评价：显示已完成待评价的订单，支持评价功能
   - ✅ 退款/售后：显示退款中的订单，支持查看退款进度

2. **订单列表展示**
   - ✅ 订单基础信息：订单号、下单时间、订单状态
   - ✅ 商品信息：商品图片、标题、规格、价格、数量
   - ✅ 物流信息：快递公司、运单号、物流状态
   - ✅ 金额信息：商品总价、实付金额显示
   - ✅ 美观的卡片式设计，信息层次清晰

3. **订单操作功能**
   - ✅ 支付订单：未付款订单支持立即付款
   - ✅ 取消订单：支持取消待付款订单
   - ✅ 催发货：对待发货订单进行催促提醒
   - ✅ 确认收货：待收货订单支持确认收货操作
   - ✅ 查看物流：跳转到物流详情页面
   - ✅ 订单评价：跳转到评价页面
   - ✅ 再次购买：将订单商品重新加入购物车
   - ✅ 申请退款：支持退款申请功能

4. **API接口封装** (`api/orderApi.js` + mock数据)
   - ✅ 获取订单列表：支持按状态筛选和分页加载
   - ✅ 订单详情获取：获取单个订单的完整信息
   - ✅ 确认收货：`confirmReceive(orderId)`
   - ✅ 取消订单：`cancelOrder(orderId, reason)`
   - ✅ 申请退款：`requestRefund(orderId, reason)`
   - ✅ 获取物流：`getLogistics(orderId)`
   - ✅ 催发货：`urgeShipping(orderId)`

### 页面入口和跳转
1. **个人中心入口**：我的 → 我的订单 → 全部订单
   - 页面路径：`/pages/order-list/index`
   - 支持查看所有订单状态

2. **快捷入口**：我的 → 我的订单 → 各状态图标
   - 待付款：`/pages/order-list/index?tab=unpaid`
   - 待发货：`/pages/order-list/index?tab=shipped`
   - 待收货：`/pages/order-list/index?tab=shipping`
   - 待评价：`/pages/order-list/index?tab=completed`
   - 退款/售后：`/pages/order-list/index?tab=refunding`

### 设计特色
1. **美观简洁的界面**
   - 采用主流电商App的订单卡片设计
   - Tab导航支持水平滚动，适配长标题
   - 订单状态用不同颜色标识，一目了然
   - 操作按钮分主次，主要操作突出显示

2. **良好的用户体验**
   - 支持下拉刷新和上拉加载更多
   - 空状态友好提示，引导用户去购买
   - 操作确认弹窗，防止误操作
   - 加载状态清晰，操作反馈及时

3. **完善的交互设计**
   - 点击商品图片可跳转到商品详情
   - 点击订单卡片可查看订单详情
   - 按钮状态根据订单状态动态显示
   - 支持各种订单状态的相应操作

### 技术实现要点
1. **遵循项目规范**
   - 使用微信小程序原生框架开发
   - 目录结构符合项目标准
   - 代码注释详细，便于0基础用户理解
   - 变量命名采用小驼峰风格

2. **状态管理优化**
   - Tab切换时自动重新加载对应数据
   - 分页加载机制，提升大量订单时的性能
   - 订单操作后自动刷新列表状态

3. **错误处理机制**
   - API请求失败时显示友好错误提示
   - 网络异常时的重试机制
   - 操作冲突时的状态保护

### Mock数据支持
当前使用丰富的mock数据进行开发测试，包含：
- 5个不同状态的示例订单
- 完整的订单信息（商品、物流、金额等）
- 真实的业务场景模拟
- 支持分页和状态筛选

### 下一步计划
1. 接入真实的支付接口（微信支付）
2. 完善物流跟踪页面
3. 添加订单评价功能页面
4. 实现退款申请和详情页面
5. 支持订单导出和分享功能

### 使用说明
1. **查看订单**：个人中心 → 我的订单 → 选择状态Tab
2. **订单操作**：在对应订单卡片底部点击操作按钮
3. **快速筛选**：使用顶部Tab快速切换订单状态
4. **刷新数据**：下拉页面可刷新订单列表
5. **加载更多**：上拉页面可加载更多历史订单

### 开发规范遵循
- ✅ 所有代码都有详细的中文注释，便于0基础用户理解
- ✅ 文件命名使用小写+中划线格式
- ✅ 函数和变量使用小驼峰命名
- ✅ 页面包含完整的 wxml、wxss、js、json 四个文件
- ✅ API接口统一使用POST方法和JSON格式
- ✅ 异常处理完善，用户体验友好
- ✅ 界面设计参考主流电商软件，美观简洁

## 最新开发 - 地址管理功能完整实现

### 功能概述
完整开发了地址管理模块，包含地址列表管理和地址编辑功能，支持从"我的"页面和"购物车结算"页面进入。

### 核心功能
1. **地址列表管理** (`pages/address-list/`)
   - ✅ 地址列表展示：显示收件人、电话、地区、详细地址
   - ✅ 编辑模式切换：支持单选、全选、批量操作
   - ✅ 多选删除：可选择多个地址进行批量删除
   - ✅ 默认地址设置：点击地址卡片设为默认地址
   - ✅ 新增地址：跳转到地址编辑页面
   - ✅ 编辑地址：修改已存在的地址信息
   - ✅ 空状态处理：无地址时显示友好的空状态界面

2. **地址编辑功能** (`pages/address-form/`)
   - ✅ 收件人信息：姓名、电话输入和验证
   - ✅ 地区选择：省市区三级联动选择器
   - ✅ 详细地址：支持多行文本输入
   - ✅ 默认地址：开关控制是否设为默认
   - ✅ 表单验证：实时验证输入内容的有效性
   - ✅ 新增/编辑：同一页面支持两种操作模式

3. **API接口封装** (`api/addressApi.js`)
   - ✅ 获取地址列表：`getAddressList()`
   - ✅ 新增地址：`addAddress(addressData)`
   - ✅ 更新地址：`updateAddress(addressData)`
   - ✅ 删除地址：`deleteAddress(addressId)`
   - ✅ 批量删除：`batchDeleteAddress(addressIds)`
   - ✅ 设置默认：`setDefaultAddress(addressId)`
   - ✅ 获取详情：`getAddressDetail(addressId)`

### 页面入口和跳转
1. **管理模式**：我的 → 常用工具 → 地址管理
   - 页面路径：`/pages/address-list/index`
   - 支持完整的增删改查操作

2. **选择模式**：商城 → 购物车 → 结算 → 收货地址
   - 页面路径：`/pages/address-list/index?from=order`
   - 选择地址后返回订单页面

### 设计特色
1. **整洁美观的界面**
   - 采用卡片式设计，层次分明
   - 使用微信小程序原生组件，保持一致性
   - 响应式布局，适配不同屏幕尺寸
   - 主题色统一使用 #4169e1（蓝色）

2. **良好的用户体验**
   - 编辑模式切换流畅，操作直观
   - 表单实时验证，及时反馈错误
   - 确认弹窗防止误删，操作安全
   - 加载状态和成功提示，交互友好

3. **完善的异常处理**
   - API请求失败时显示友好错误提示
   - 表单验证不通过时阻止提交
   - 网络异常时自动重试机制

### 技术实现要点
1. **遵循项目规范**
   - 使用微信小程序原生框架开发
   - 目录结构符合项目标准
   - 代码注释详细，方便维护
   - 变量命名采用小驼峰风格

2. **数据流管理**
   - 页面间数据传递通过URL参数
   - 表单状态管理使用页面data
   - 选中状态实时更新和同步

3. **性能优化**
   - 列表渲染使用wx:key优化
   - 图片懒加载和合理缓存
   - 避免不必要的页面重新渲染

### Mock数据支持
当前使用mock数据进行开发测试，包含：
- 3个预设的示例地址
- 完整的CRUD操作模拟
- 真实的业务场景覆盖

### 下一步计划
1. 接入真实后端API接口
2. 添加地址地图定位功能
3. 支持常用地址模板
4. 添加地址导入和导出功能
5. 优化大量地址时的性能表现

### 使用说明
1. **地址管理入口**：个人中心 → 常用工具 → 地址管理
2. **地址选择入口**：购物车 → 结算 → 选择收货地址
3. **新增地址**：点击"新增地址"按钮
4. **编辑地址**：点击地址卡片右侧的编辑图标
5. **批量删除**：点击"编辑"按钮进入多选模式
6. **设置默认**：在管理模式下点击地址卡片

### 开发规范遵循
- ✅ 所有代码都有详细的中文注释，便于理解
- ✅ 文件命名使用小写+中划线格式
- ✅ 函数和变量使用小驼峰命名
- ✅ 页面包含完整的 wxml、wxss、js、json 四个文件
- ✅ API接口统一使用POST方法和JSON格式
- ✅ 异常处理完善，用户体验友好

## 地址管理功能

### 功能入口
用户可以通过以下两个入口访问地址管理功能：

#### 1. 个人中心入口
- **位置**：个人中心页面 → 常用工具 → 地址管理
- **路径**：`/pages/personal/index` → `/pages/address-list/index`
- **用途**：用于日常地址管理（新增、编辑、删除地址）

#### 2. 订单确认页面入口
- **位置**：订单确认页面 → 收货地址模块 → 点击地址区域
- **路径**：`/pages/order-confirm/order-confirm` → `/pages/address-list/index?from=order-confirm`
- **用途**：用于订单流程中选择收货地址

### 页面注册说明
为确保页面能正常跳转，请检查 `app.json` 中是否正确注册了以下页面：
```json
{
  "pages": [
    "pages/address-list/index",    // 地址列表页面
    "pages/address-form/index"     // 地址编辑页面
  ]
}
```

### 故障排除
如果遇到跳转失败的问题，请检查：

1. **页面路径是否正确**
   - 确保跳转路径与 `app.json` 中注册的路径一致
   - 个人中心：`/pages/address-list/index`
   - 订单确认：`/pages/address-list/index?from=order-confirm`

2. **页面文件是否完整**
   - 确保 `pages/address-list/` 目录下有完整的四个文件：
     - `index.wxml`（页面结构）
     - `index.wxss`（页面样式）
     - `index.js`（页面逻辑）
     - `index.json`（页面配置）

3. **API接口是否正常**
   - 检查 `api/addressApi.js` 文件是否存在
   - 确保后端接口正常响应

### 测试步骤
1. 打开个人中心页面，点击"地址管理"，应该能跳转到地址列表页面
2. 在地址列表页面点击"新增地址"，应该能跳转到地址编辑页面
3. 在订单确认页面点击收货地址区域，应该能跳转到地址选择页面
4. 在地址选择页面选择地址后，应该能正确返回订单确认页面并更新地址信息 

## 订单管理功能测试说明

### 📦 订单页面测试数据

为了便于开发和测试，我们在 `/api/utils/request.js` 中添加了丰富的订单mock数据，包含以下测试场景：

#### 🔹 测试订单列表
目前系统包含6个测试订单，覆盖所有订单状态：

1. **ORDER001** - 待付款状态
   - 商品：李宁羽毛球拍 + GOSEN羽毛球
   - 金额：¥486.00
   - 测试功能：取消订单、立即付款

2. **ORDER002** - 待发货状态  
   - 商品：威克多羽毛球拍
   - 金额：¥1288.00
   - 测试功能：催发货、查看物流

3. **ORDER003** - 待收货状态
   - 商品：尤尼克斯球鞋 + 威克多球包
   - 金额：¥866.00  
   - 物流信息：圆通快递
   - 测试功能：查看物流、确认收货

4. **ORDER004** - 待评价状态
   - 商品：李宁羽毛球服
   - 金额：¥158.00
   - 测试功能：再次购买、去评价

5. **ORDER005** - 退款中状态
   - 商品：李宁羽毛球拍  
   - 金额：¥299.00
   - 测试功能：查看退款详情

6. **ORDER006** - 待付款状态
   - 商品：李宁羽毛球服 + 威克多球包
   - 金额：¥356.00

#### 🔹 如何查看测试数据

1. **进入订单页面的方式：**
   ```
   方式一：通过个人中心 → 点击"我的订单"
   方式二：直接访问 pages/order-list/index
   ```

2. **测试不同状态的订单：**
   - 点击顶部tab可以筛选不同状态的订单
   - 全部、待付款、待发货、待收货、待评价、退款/售后

3. **测试订单操作：**
   - 待付款订单：可以取消订单或立即付款
   - 待发货订单：可以催发货  
   - 待收货订单：可以查看物流、确认收货
   - 待评价订单：可以再次购买、去评价

#### 🔹 商品数据说明

所有商品图片和信息都是真实的羽毛球用品数据，包括：
- 李宁N72羽毛球拍
- 威克多ARS90K羽毛球拍  
- 尤尼克斯专业球鞋
- 李宁羽毛球服套装
- 威克多羽毛球包
- GOSEN羽毛球

#### ⚠️ 注意事项

1. **这些是开发测试数据**，在`request.js`文件中用注释明确标注
2. **正式发布前需要替换为真实接口**
3. **所有订单操作（取消、确认收货等）都会显示成功提示**
4. **数据修改后页面会自动刷新**

#### 🛠️ 开发说明

测试数据位置：`miniprogram/api/utils/request.js` 
- 搜索 "订单相关mock数据" 可以快速定位
- 可以根据需要修改订单状态、商品信息、价格等
- 支持分页加载和状态筛选功能 

## 最新开发 - 退款详情页面完整实现

### 功能概述
完整开发了退款详情页面，展示退款申请的详细信息、商品信息、退款进度等，支持从订单列表的"退款/售后"状态跳转进入。

### 核心功能
1. **退款基本信息展示** (`pages/refund-detail/`)
   - ✅ 订单号和退款编号显示，支持一键复制
   - ✅ 退款金额和当前状态醒目展示
   - ✅ 退款方式、退款原因详细说明
   - ✅ 申请时间、处理时间、完成时间记录

2. **商品信息展示**
   - ✅ 商品主图、标题、规格信息
   - ✅ 商品价格和退款数量显示
   - ✅ 清晰的卡片式布局设计

3. **退款进度时间线**
   - ✅ 申请提交 → 商家处理 → 退款完成的进度流程
   - ✅ 不同状态用不同颜色和图标标识
   - ✅ 每个步骤显示对应的时间和详细说明
   - ✅ 支持"退款中"、"已完成"、"已驳回"等状态

4. **交互功能**
   - ✅ 订单号、退款编号支持点击复制
   - ✅ 底部"联系客服"按钮，支持在线客服和电话客服
   - ✅ 下拉刷新功能，实时更新退款进度
   - ✅ 页面分享功能，可分享退款详情给他人

### Mock数据支持
当前使用丰富的mock数据进行开发测试，包含：
- **退款中状态**：显示商家正在处理的退款申请
- **已完成状态**：显示已成功退款的详细信息
- **已驳回状态**：显示被驳回的退款申请和原因
- 真实的商品信息和退款流程模拟
- 完整的时间线进度展示

### 页面入口和跳转
1. **从订单列表进入**
   ```javascript
   // 从退款/售后订单跳转
   wx.navigateTo({
     url: `/pages/refund-detail/refund-detail?orderNo=ORDER123456&refundNo=REFUND789`
   });
   ```

2. **页面参数说明**
   - `orderNo`: 订单号（必传）
   - `refundNo`: 退款编号（必传）

### 设计特色
1. **信息层次清晰**
   - 采用卡片分区布局，信息分组明确
   - 重要信息（退款金额、状态）突出显示
   - 时间线设计直观展示退款进度

2. **状态标识明确**
   - 退款中：蓝色标识，显示处理进度
   - 已完成：绿色标识，显示成功状态
   - 已驳回：红色标识，显示失败原因

3. **操作便捷友好**
   - 一键复制订单号和退款编号
   - 快速联系客服解决问题
   - 下拉刷新获取最新状态

### 技术实现要点
1. **遵循项目规范**
   - 使用微信小程序原生框架开发
   - 文件命名：`refund-detail`（小写+中划线）
   - 包含完整的 js、json、wxml、wxss 四个文件
   - 详细的中文注释，便于0基础用户理解

2. **数据处理机制**
   - 根据参数动态选择不同状态的mock数据
   - 支持API接口预留，便于后续真实数据对接
   - 完善的错误处理和加载状态

3. **UI设计优化**
   - 响应式布局，适配不同屏幕尺寸
   - 优雅的加载动画和错误提示
   - 符合微信小程序设计规范

### 样式设计亮点
1. **时间线组件**
   - 圆点和连线的视觉效果
   - 不同状态的颜色区分
   - 当前步骤的高亮显示效果

2. **状态标签**
   - 圆角设计，视觉友好
   - 背景色和文字色搭配协调
   - 根据状态动态切换样式

3. **操作按钮**
   - 底部固定联系客服按钮
   - 点击态反馈效果
   - 安全区域适配

### 后续优化计划
1. 接入真实的退款API接口
2. 增加退款凭证上传功能
3. 支持退款进度推送通知
4. 添加更多客服联系方式
5. 支持退款详情导出功能

### 使用说明
1. **查看退款详情**：订单列表 → 退款/售后订单 → 点击"退款详情"
2. **复制信息**：点击订单号或退款编号右侧的"复制"按钮
3. **联系客服**：点击底部"联系客服"按钮选择联系方式
4. **刷新进度**：下拉页面可刷新最新的退款进度
5. **分享详情**：点击右上角分享按钮可分享退款详情

### 开发规范遵循
- ✅ 所有代码都有详细的中文注释，便于0基础用户理解
- ✅ 文件命名使用小写+中划线格式：`refund-detail`
- ✅ 函数和变量使用小驼峰命名：`loadRefundDetail`、`productInfo`
- ✅ 页面包含完整的 wxml、wxss、js、json 四个文件
- ✅ Mock数据结构完整，便于后续API对接
- ✅ 异常处理完善，用户体验友好
- ✅ UI设计美观，符合主流App设计风格

## 地址管理功能

### 功能入口
用户可以通过以下两个入口访问地址管理功能：

#### 1. 个人中心入口
- **位置**：个人中心页面 → 常用工具 → 地址管理
- **路径**：`/pages/personal/index` → `/pages/address-list/index`
- **用途**：用于日常地址管理（新增、编辑、删除地址）

#### 2. 订单确认页面入口
- **位置**：订单确认页面 → 收货地址模块 → 点击地址区域
- **路径**：`/pages/order-confirm/order-confirm` → `/pages/address-list/index?from=order-confirm`
- **用途**：用于订单流程中选择收货地址

### 页面注册说明
为确保页面能正常跳转，请检查 `app.json` 中是否正确注册了以下页面：
```json
{
  "pages": [
    "pages/address-list/index",    // 地址列表页面
    "pages/address-form/index"     // 地址编辑页面
  ]
}
```

### 故障排除
如果遇到跳转失败的问题，请检查：

1. **页面路径是否正确**
   - 确保跳转路径与 `app.json` 中注册的路径一致
   - 个人中心：`/pages/address-list/index`
   - 订单确认：`/pages/address-list/index?from=order-confirm`

2. **页面文件是否完整**
   - 确保 `pages/address-list/` 目录下有完整的四个文件：
     - `index.wxml`（页面结构）
     - `index.wxss`（页面样式）
     - `index.js`（页面逻辑）
     - `index.json`（页面配置）

3. **API接口是否正常**
   - 检查 `api/addressApi.js` 文件是否存在
   - 确保后端接口正常响应

### 测试步骤
1. 打开个人中心页面，点击"地址管理"，应该能跳转到地址列表页面
2. 在地址列表页面点击"新增地址"，应该能跳转到地址编辑页面
3. 在订单确认页面点击收货地址区域，应该能跳转到地址选择页面
4. 在地址选择页面选择地址后，应该能正确返回订单确认页面并更新地址信息 

## 订单管理功能测试说明

### 📦 订单页面测试数据

为了便于开发和测试，我们在 `/api/utils/request.js` 中添加了丰富的订单mock数据，包含以下测试场景：

#### 🔹 测试订单列表
目前系统包含6个测试订单，覆盖所有订单状态：

1. **ORDER001** - 待付款状态
   - 商品：李宁羽毛球拍 + GOSEN羽毛球
   - 金额：¥486.00
   - 测试功能：取消订单、立即付款

2. **ORDER002** - 待发货状态  
   - 商品：威克多羽毛球拍
   - 金额：¥1288.00
   - 测试功能：催发货、查看物流

3. **ORDER003** - 待收货状态
   - 商品：尤尼克斯球鞋 + 威克多球包
   - 金额：¥866.00  
   - 物流信息：圆通快递
   - 测试功能：查看物流、确认收货

4. **ORDER004** - 待评价状态
   - 商品：李宁羽毛球服
   - 金额：¥158.00
   - 测试功能：再次购买、去评价

5. **ORDER005** - 退款中状态
   - 商品：李宁羽毛球拍  
   - 金额：¥299.00
   - 测试功能：查看退款详情

6. **ORDER006** - 待付款状态
   - 商品：李宁羽毛球服 + 威克多球包
   - 金额：¥356.00

#### 🔹 如何查看测试数据

1. **进入订单页面的方式：**
   ```
   方式一：通过个人中心 → 点击"我的订单"
   方式二：直接访问 pages/order-list/index
   ```

2. **测试不同状态的订单：**
   - 点击顶部tab可以筛选不同状态的订单
   - 全部、待付款、待发货、待收货、待评价、退款/售后

3. **测试订单操作：**
   - 待付款订单：可以取消订单或立即付款
   - 待发货订单：可以催发货  
   - 待收货订单：可以查看物流、确认收货
   - 待评价订单：可以再次购买、去评价

#### 🔹 商品数据说明

所有商品图片和信息都是真实的羽毛球用品数据，包括：
- 李宁N72羽毛球拍
- 威克多ARS90K羽毛球拍  
- 尤尼克斯专业球鞋
- 李宁羽毛球服套装
- 威克多羽毛球包
- GOSEN羽毛球

#### ⚠️ 注意事项

1. **这些是开发测试数据**，在`request.js`文件中用注释明确标注
2. **正式发布前需要替换为真实接口**
3. **所有订单操作（取消、确认收货等）都会显示成功提示**
4. **数据修改后页面会自动刷新**

#### 🛠️ 开发说明

测试数据位置：`miniprogram/api/utils/request.js` 
- 搜索 "订单相关mock数据" 可以快速定位
- 可以根据需要修改订单状态、商品信息、价格等
- 支持分页加载和状态筛选功能 