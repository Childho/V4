<!-- æˆ‘çš„è®¢å•é¡µé¢ -->
<view class="order-page">
  <!-- tabå¯¼èˆªæ  -->
  <view class="tab-bar">
    <scroll-view class="tab-scroll" scroll-x="true">
      <view class="tab-list">
        <view 
          wx:for="{{tabs}}" 
          wx:key="id"
          class="tab-item {{currentTab === index ? 'active' : ''}}"
          data-index="{{index}}"
          bindtap="onTabChange"
        >
          {{item.name}}
        </view>
      </view>
    </scroll-view>
  </view>

  <!-- è®¢å•åˆ—è¡¨ -->
  <view class="order-content">
    <!-- ç©ºçŠ¶æ€ -->
    <view wx:if="{{!loading && orderList.length === 0}}" class="empty-state">
      <view class="empty-icon">ğŸ“¦</view>
      <text class="empty-text">æš‚æ— ç›¸å…³è®¢å•</text>
      <text class="empty-desc">å¿«å»ä¸‹å•å§~</text>
    </view>

    <!-- è®¢å•åˆ—è¡¨ -->
    <view wx:else class="order-list">
      <view 
        wx:for="{{orderList}}" 
        wx:key="id"
        class="order-item"
        data-order-id="{{item.id}}"
        bindtap="onOrderDetailClick"
      >
        <!-- è®¢å•å¤´éƒ¨ -->
        <view class="order-header">
          <view class="order-info">
            <text class="order-id">è®¢å•å·ï¼š{{item.id}}</text>
            <text class="order-time">{{item.createTime}}</text>
          </view>
          <view class="order-status {{item.status}}">{{item.statusText}}</view>
        </view>

        <!-- å•†å“åˆ—è¡¨ -->
        <view class="goods-list">
          <view 
            wx:for="{{item.goods}}" 
            wx:for-item="goods"
            wx:key="id"
            class="goods-item"
            data-goods-id="{{goods.id}}"
            catchtap="onGoodsClick"
          >
            <image class="goods-image" src="{{goods.image}}" mode="aspectFill"></image>
            <view class="goods-info">
              <text class="goods-title">{{goods.title}}</text>
              <text class="goods-spec">{{goods.spec}}</text>
              <view class="goods-price-quantity">
                <text class="goods-price">Â¥{{goods.price}}</text>
                <text class="goods-quantity">Ã—{{goods.quantity}}</text>
              </view>
            </view>
          </view>
        </view>

        <!-- ç‰©æµä¿¡æ¯ -->
        <view wx:if="{{item.logistics.company}}" class="logistics-info">
          <text class="logistics-text">{{item.logistics.company}} {{item.logistics.trackingNo}}</text>
          <text class="logistics-status">{{item.logistics.status}}</text>
        </view>

        <!-- è®¢å•é‡‘é¢ -->
        <view class="order-amount">
          <text class="amount-label">å…±{{item.goods.length}}ä»¶å•†å“ å®ä»˜ï¼š</text>
          <text class="amount-value">Â¥{{item.totalAmount}}</text>
        </view>

        <!-- æ“ä½œæŒ‰é’®åŒºåŸŸ -->
        <view class="order-actions">
          <!-- å¾…ä»˜æ¬¾çŠ¶æ€ -->
          <block wx:if="{{item.status === 'unpaid'}}">
            <button 
              class="action-btn cancel" 
              data-order-id="{{item.id}}"
              catchtap="onCancelOrder"
            >å–æ¶ˆè®¢å•</button>
            <button 
              class="action-btn primary" 
              data-order-id="{{item.id}}"
              catchtap="onPayOrder"
            >ç«‹å³ä»˜æ¬¾</button>
          </block>

          <!-- å¾…å‘è´§çŠ¶æ€ -->
          <block wx:elif="{{item.status === 'shipped'}}">
            <button 
              class="action-btn default" 
              data-order-id="{{item.id}}"
              catchtap="onUrgeShipping"
            >å‚¬å‘è´§</button>
            <button 
              class="action-btn primary" 
              data-order-id="{{item.id}}"
              catchtap="onLogisticsClick"
            >æŸ¥çœ‹ç‰©æµ</button>
          </block>

          <!-- å¾…æ”¶è´§çŠ¶æ€ -->
          <block wx:elif="{{item.status === 'shipping'}}">
            <button 
              class="action-btn default" 
              data-order-id="{{item.id}}"
              catchtap="onLogisticsClick"
            >æŸ¥çœ‹ç‰©æµ</button>
            <button 
              class="action-btn primary" 
              data-order-id="{{item.id}}"
              catchtap="onConfirmReceive"
            >ç¡®è®¤æ”¶è´§</button>
          </block>

          <!-- å¾…è¯„ä»·çŠ¶æ€ -->
          <block wx:elif="{{item.status === 'completed'}}">
            <button 
              class="action-btn default" 
              data-order="{{item}}"
              catchtap="onBuyAgain"
            >å†æ¬¡è´­ä¹°</button>
            <button 
              class="action-btn primary" 
              data-order-id="{{item.id}}"
              catchtap="onGoEvaluate"
            >å»è¯„ä»·</button>
          </block>

          <!-- é€€æ¬¾ä¸­çŠ¶æ€ -->
          <block wx:elif="{{item.status === 'refunding'}}">
            <button 
              class="action-btn default" 
              data-order-id="{{item.id}}"
              catchtap="onLogisticsClick"
            >æŸ¥çœ‹ç‰©æµ</button>
            <button 
              class="action-btn primary" 
              data-order-id="{{item.id}}"
              catchtap="onRefundDetail"
            >é€€æ¬¾è¯¦æƒ…</button>
          </block>

          <!-- é€šç”¨æ“ä½œï¼šåˆ é™¤è®¢å• -->
          <button 
            wx:if="{{item.status === 'completed' || item.status === 'cancelled'}}"
            class="action-btn delete" 
            data-order-id="{{item.id}}"
            catchtap="onDeleteOrder"
          >åˆ é™¤è®¢å•</button>
        </view>
      </view>
    </view>

    <!-- åŠ è½½æ›´å¤š -->
    <view wx:if="{{loading}}" class="loading">
      <text>åŠ è½½ä¸­...</text>
    </view>
    
    <view wx:elif="{{!hasMore && orderList.length > 0}}" class="no-more">
      <text>æ²¡æœ‰æ›´å¤šè®¢å•äº†</text>
    </view>
  </view>
</view> 