# 优惠券页面

## 功能简介
优惠券页面用于展示用户的所有优惠券，支持按状态分类查看、使用优惠券等功能。

## 最新更新 (2024-03-XX)

### 主要变化
1. **Tab标签页调整**：
   - 移除了"已使用"tab标签页
   - 将原来的"已过期"tab改为"即将过期"tab
   - 现在包含：全部、可使用、即将过期

2. **数据模型更新**：
   - 新增状态码 `status: 4` 表示即将过期状态
   - 移除了已使用状态的模拟数据
   - 新增了7条即将过期的优惠券模拟数据

3. **UI样式优化**：
   - 为即将过期的优惠券添加了橙色警告样式
   - 添加了呼吸动画效果提醒用户注意
   - 即将过期的优惠券显示特殊的警告文字

4. **交互体验提升**：
   - 即将过期的优惠券按钮文字改为"赶紧使用"
   - 确认弹窗中为即将过期优惠券添加特别提醒
   - 支持在订单确认页面选择即将过期的优惠券

## 文件结构
```
/pages/coupon/
├── index.js      # 页面逻辑代码（包含模拟数据）
├── index.wxml    # 页面模板文件
├── index.wxss    # 页面样式文件
├── index.json    # 页面配置文件
└── README.md     # 说明文档
```

## 状态说明
- `status: 0` - 全部（用于筛选，显示可使用+即将过期）
- `status: 1` - 可使用
- `status: 4` - 即将过期（新增状态）

## 样式类名
- `.coupon-item.expiring` - 即将过期的优惠券卡片
- `.expire-warning` - 即将过期警告文字
- `.expiring-tag` - 即将过期状态标签
- `.select-btn.warning` - 警告样式的选择按钮
- `.use-btn.warning` - 警告样式的使用按钮

## 模拟数据
现在包含以下类型的模拟数据：
- 可使用优惠券：7条
- 即将过期优惠券：7条（新增）
- 总计：14条模拟数据

所有即将过期的优惠券都设置了橙色警告样式，并带有呼吸动画效果，提醒用户尽快使用。

## 注意事项
1. 实际开发时需要将mock数据替换为真实API调用
2. 即将过期的判断逻辑需要根据实际业务需求调整
3. 动画效果在iOS和Android上可能有差异，需要测试兼容性

## 页面功能概述

这是一个完整的优惠券管理页面，支持查看、筛选、选择和使用优惠券等功能。

## 主要功能特性

### 1. Tab筛选功能
- **全部**：显示所有状态的优惠券
- **可使用**：显示状态为可用的优惠券
- **即将过期**：显示即将过期无法使用的优惠券

### 2. 优惠券类型支持
- **满减券**：满足最低消费金额后可减免指定金额
- **折扣券**：按照折扣比例计算优惠金额
- **免邮券**：免除订单运费，无最低消费限制

### 3. 优惠券状态管理
- **可使用**：绿色样式，显示"立即使用"或"选择"按钮
- **即将过期**：橙色警告样式，显示"赶紧使用"按钮

### 4. 空状态处理
- 不同Tab显示相应的空状态提示文案
- 自定义优惠券空状态图标
- 友好的引导文案提示用户去领取优惠券

### 5. 分页加载
- 支持下拉刷新重新加载数据
- 支持上拉加载更多数据
- 模拟真实的分页加载效果

## 数据结构说明

### 优惠券数据字段
```javascript
{
  id: 101,                    // 优惠券唯一标识
  title: '新用户专享大礼包',     // 优惠券标题
  amount: 50,                 // 优惠金额或折扣比例
  minAmount: 99,              // 最低使用金额
  type: 1,                    // 优惠券类型：1=满减券，2=折扣券，3=免邮券
  scope: '全场通用',           // 适用范围
  startTime: '2024-01-01',    // 有效期开始时间
  endTime: '2024-12-31',      // 有效期结束时间
  status: 1,                  // 优惠券状态：1=可使用，4=即将过期
  useTime: null,              // 使用时间（已使用状态才有值）
  description: '新用户注册即得...', // 优惠券描述
  discount: 50                // 实际优惠金额（用于订单计算）
}
```

## Mock测试数据

### 可使用优惠券（7张）
1. **新用户专享大礼包**：满99减50元，全场通用
2. **服装类8折优惠券**：满150元享8折，服装鞋帽类
3. **满200减30优惠券**：电子数码产品专用
4. **免邮券**：全场通用，无门槛免运费
5. **家具家电9折券**：满500元享9折
6. **满500减80元券**：美妆护肤类专用
7. **无门槛5元券**：零食饮料类，情人节专享

### 即将过期优惠券（7张）
1. **即将过期优惠券1**：即将过期优惠券描述
2. **即将过期优惠券2**：即将过期优惠券描述
3. **即将过期优惠券3**：即将过期优惠券描述
4. **即将过期优惠券4**：即将过期优惠券描述
5. **即将过期优惠券5**：即将过期优惠券描述
6. **即将过期优惠券6**：即将过期优惠券描述
7. **即将过期优惠券7**：即将过期优惠券描述

## 使用场景

### 1. 个人中心访问
- 用户从个人中心进入查看自己的优惠券
- 支持查看、使用优惠券
- 显示"立即使用"按钮

### 2. 订单确认页面选择
- 从订单确认页面跳转过来选择优惠券
- 只显示满足订单金额条件的可用优惠券
- 显示"选择"按钮，选择后返回订单页面

## 交互说明

### 1. Tab切换
- 点击不同Tab可以筛选不同状态的优惠券
- 切换时会清空当前列表并重新加载数据
- 支持平滑的切换动画效果

### 2. 优惠券使用
- 点击"立即使用"弹出确认弹窗
- 确认后模拟调用后端API使用优惠券
- 使用成功后刷新列表显示最新状态

### 3. 优惠券选择（订单页面调用）
- 检查优惠券可用性和使用条件
- 保存选中的优惠券到本地存储
- 自动返回到订单确认页面

## 技术实现

### 1. 页面生命周期
- `onLoad`：处理页面参数，设置标题和初始Tab
- `onShow`：每次显示时重新加载数据
- `onPullDownRefresh`：下拉刷新处理
- `onReachBottom`：上拉加载更多处理

### 2. 数据管理
- 使用`getMockCouponData`方法生成模拟数据
- 根据状态参数过滤相应的优惠券数据
- 支持分页加载，模拟真实API调用效果

### 3. 状态管理
- 维护当前选中的Tab状态
- 管理加载状态和分页信息
- 处理空状态和错误状态

## 样式设计

### 1. 视觉层次
- 橙色渐变主题色彩搭配
- 清晰的卡片式布局设计
- 优雅的圆角和阴影效果

### 2. 状态区分
- 可用优惠券：正常色彩，醒目的按钮
- 即将过期优惠券：橙色警告样式，醒目的按钮

### 3. 响应式设计
- 使用rpx单位适配不同屏幕尺寸
- 灵活的flex布局适应内容变化
- 流畅的动画和过渡效果

## 开发注意事项

1. **Mock数据替换**：实际开发时需要将`getMockCouponData`方法替换为真实的API调用
2. **错误处理**：需要完善网络请求失败的错误处理逻辑
3. **性能优化**：大量优惠券时可考虑虚拟列表优化
4. **用户体验**：可以添加骨架屏提升加载体验

## 扩展功能建议

1. **搜索功能**：支持按优惠券名称或适用范围搜索
2. **排序功能**：支持按金额、时间等维度排序
3. **分类筛选**：支持按适用范围分类筛选
4. **到期提醒**：即将过期的优惠券显示提醒信息
5. **使用统计**：显示优惠券使用统计和节省金额 